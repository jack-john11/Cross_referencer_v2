# Story 1.2: Implement Project Edit UI

## Story Information
- **Epic**: 1.2 - Project Editing and Details Management
- **Story Number**: 1.2.1
- **Title**: Implement Project Edit UI
- **Status**: Draft

## Story
As an ecological consultant, I want to navigate to an edit page for a project and see a form pre-filled with its current details, so that I can easily view and prepare to modify the project's information.

## Acceptance Criteria
1.  **AC1**: An "Edit" button on the project details page (`/projects/[id]`) navigates the user to a new project edit page (`/projects/[id]/edit`).
2.  **AC2**: The project edit page displays a form with fields for Project Name, Description, and Location.
3.  **AC3**: The form fields are pre-populated with the existing data for the project being edited.
4.  **AC4**: The form reuses the same validation rules (Zod schema) and styling as the "Create Project" form for consistency.
5.  **AC5**: The UI provides clear navigation back to the project details page or the main dashboard without saving.

## Dev Notes

### Previous Story Insights
- This story builds directly upon the components and state management logic established in Story 1.1. The "Create Project" form (`apps/web/app/(authenticated)/projects/create/page.tsx`) should be used as the primary reference for the UI pattern, validation, and component composition.

### Data Models
- The story will use the existing `Project` schema. The form will need to fetch the current project's data to pre-populate the fields.
  - **Firestore Collection**: `projects`
  - **Schema Source**: `packages/shared-types/src/database/project-schema.ts`

### API Specifications
- This story is UI-focused and will not directly interact with the API. It will, however, rely on the state management layer to fetch the project data that was originally retrieved via the `GET /api/projects/{id}` endpoint.

### Component Specifications
- **Project Edit Form**: A new component or page that closely mirrors the "Create Project" form. It should be composed of the same `Card`, `Input`, `Textarea`, and `Button` components from `shadcn/ui`.
- **State Management**: The component will interact with the `ProjectManagementStore` (Zustand) to:
    - Get the current project's data to populate the form.
    - (In the next story) Call the `updateProject` action upon submission.
  - **Store Location**: `apps/web/lib/stores/project-management.ts`

### File Locations
- **New Page**: `apps/web/app/(authenticated)/projects/[id]/edit/page.tsx`
- **New Test File**: `apps/web/app/(authenticated)/projects/[id]/edit/page.test.tsx`

### Testing Requirements
- **Unit Tests**:
    - Verify that the edit page renders correctly with all form fields.
    - Confirm that the form fields are correctly pre-populated with mock project data.
    - Test that navigation links (e.g., "Back to Project") work as expected.
    - Ensure form validation messages appear for invalid data, consistent with the create form.

## Tasks / Subtasks

### Task 1: Create Project Edit Page Structure (AC: 1, 2)
- [ ] Create the new file `apps/web/app/(authenticated)/projects/[id]/edit/page.tsx`.
- [ ] Implement the basic page layout, including the header and a form container, reusing the structure from the `CreateProjectPage`.
- [ ] Add a "Back to Project" or similar navigation element to return to the project details page (`/projects/[id]`).

### Task 2: Implement Data Fetching and Form Population (AC: 3)
- [ ] In the `useEffect` hook of the new edit page, fetch the project's data using the `getProject` action from the `useProjectManagementStore`.
- [ ] Use `react-hook-form`'s `reset` function to populate the form fields with the fetched project data once it's available.
- [ ] Implement a loading state to be displayed while the project data is being fetched.

### Task 3: Adapt "Create Project" Form for Editing (AC: 2, 4)
- [ ] Copy the form structure from `CreateProjectPage` into the new `EditProjectPage`.
- [ ] Change the page title and description from "Create" to "Edit".
- [ ] Ensure the form uses the same `zodResolver` with the `projectFormSchema` for consistent validation.
- [ ] The final "Save" or "Submit" button should be present but will be wired up in the next story. For now, it can be disabled.

### Task 4: Implement Unit Tests (AC: 1, 2, 3, 4, 5)
- [ ] Create the new test file `apps/web/app/(authenticated)/projects/[id]/edit/page.test.tsx`.
- [ ] Write tests to verify the component renders correctly in a loading state.
- [ ] Write tests to confirm the form is populated with data provided by a mock Zustand store.
- [ ] Write tests to check that validation errors are displayed correctly.
- [ ] Write tests to ensure the "Back" navigation works as intended.
