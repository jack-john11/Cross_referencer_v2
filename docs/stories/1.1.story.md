# Story 1.1: Project Creation and Management

## Story Information
- **Epic**: 1 - Project and File Management  
- **Story Number**: 1.1
- **Title**: Project Creation and Management
- **Status**: Draft
- **Agent Model Used**: Claude 3.5 Sonnet

## Story
As an ecological consultant, I need to create and manage distinct projects so that I can organize my reports and associated data files in separate containers for different ecological assessments.

## Acceptance Criteria
1. **AC1**: Users can create a new project with a name, description, and location
2. **AC2**: Projects are displayed in a dashboard view showing project metadata
3. **AC3**: Users can access existing projects from the dashboard
4. **AC4**: Project data is isolated between different projects
5. **AC5**: Projects persist in the database with proper audit trails

## Dev Notes

### Previous Story Insights
No previous stories - this is the first implementation story.

### Data Models
**Project Schema** [Source: docs/backend-architecture.md#Data Layer]:
```typescript
interface Project {
  id: string
  name: string
  description: string
  location: string
  createdAt: Timestamp
  updatedAt: Timestamp
  userId: string
  status: 'active' | 'archived'
  correlationId: string
  auditTrail: {
    action: string
    userId: string
    timestamp: Timestamp
  }
}
```

**Firestore Collection**: `projects` (lowercase with underscores) [Source: docs/architecture/coding-standards.md#Naming Conventions]

### API Specifications
**Backend API Endpoints** [Source: docs/architecture/source-tree.md#/functions/src/api/projects/]:
- `POST /api/projects` - Create new project
- `GET /api/projects` - List user's projects  
- `GET /api/projects/{id}` - Get specific project
- `PUT /api/projects/{id}` - Update project
- `DELETE /api/projects/{id}` - Archive project

**Request/Response Types** [Source: docs/architecture/source-tree.md#/packages/shared-types/src/api/]:
- All API request/response interfaces must be defined in shared-types package
- Include correlationId in all requests [Source: docs/architecture/coding-standards.md#Critical Rules]

### Component Specifications
**Frontend Components** [Source: docs/front-end-architecture.md#Component Architecture]:
- **Project Dashboard** - located in `apps/web/app/(authenticated)/dashboard/`
- **Project Creation Form** - modal or separate page for project creation
- **Project Card** - component for displaying project summary in dashboard

**State Management** [Source: docs/front-end-architecture.md#State Architecture]:
- **ProjectManagementStore** (Zustand) - manages project CRUD operations and dashboard state
- Located in `apps/web/lib/stores/project-management.ts`

### File Locations
**Frontend Files** [Source: docs/architecture/source-tree.md]:
- `/apps/web/app/(authenticated)/dashboard/page.tsx` - Dashboard view
- `/apps/web/app/(authenticated)/projects/create/page.tsx` - Project creation page
- `/apps/web/components/features/project-management/` - Project-specific components
- `/apps/web/lib/stores/project-management.ts` - Project state management

**Backend Files** [Source: docs/architecture/source-tree.md]:
- `/functions/src/api/projects/` - HTTP endpoint handlers
- `/functions/src/services/data-management/project-service.ts` - Business logic
- `/packages/shared-types/src/api/project-types.ts` - Type definitions
- `/packages/shared-types/src/database/project-schema.ts` - Database schema types

### Testing Requirements
Based on testing strategy, implement:
- **Unit Tests**: Co-located `*.test.ts` files for each component and service
- **API Integration Tests**: Test project CRUD operations with Firebase emulators
- **E2E Tests**: Project creation and dashboard navigation workflows

### Technical Constraints
**Australian Compliance** [Source: docs/architecture/tech-stack.md#Australian Compliance]:
- All Firestore operations must specify `australia-southeast1` region
- Include correlationId in all database writes for audit compliance
- Use structured logging with correlation IDs [Source: docs/architecture/coding-standards.md#Critical Rules]

**Performance** [Source: docs/architecture/tech-stack.md]:
- Firebase Functions: 512MB memory for API endpoints
- Timeout: 60s for project operations (non-AI functions)

### Project Structure Notes
All file paths align with established monorepo structure. Project creation components should follow the feature-based organization pattern defined in the source tree.

## Tasks / Subtasks

### Task 1: Setup Project Data Models and Types (AC: 4, 5)
- [x] Create project schema types in `packages/shared-types/src/database/project-schema.ts`
- [x] Create API request/response types in `packages/shared-types/src/api/project-types.ts`
- [x] Add project types to shared-types index exports
- [x] Implement Zod validation schemas for project data
- [x] Unit test: Validate type definitions and schema validation

### Task 2: Implement Backend Project Service (AC: 4, 5)
- [x] Create `functions/src/services/data-management/project-service.ts` with CRUD operations
- [x] Implement Firebase Functions in `functions/src/api/projects/` for HTTP endpoints
- [x] Add correlationId and audit trail to all database operations
- [x] Implement proper error handling with structured logging
- [x] Configure australia-southeast1 region for all Firestore operations
- [x] Unit test: Test project service CRUD operations with Firebase emulators
- [x] Integration test: Test API endpoints with authentication

### Task 3: Create Project Management Frontend Store (AC: 1, 2, 3)
- [x] Implement `apps/web/lib/stores/project-management.ts` using Zustand
- [x] Add actions for create, read, update, delete projects
- [x] Implement async state handling (loading, error, success states)
- [x] Add correlation ID generation for API calls
- [x] Unit test: Test store actions and state updates

### Task 4: Build Project Dashboard UI (AC: 2, 3)
- [x] Create `apps/web/app/(authenticated)/dashboard/page.tsx` 
- [x] Implement project list view with card components
- [x] Add project search and filtering capabilities
- [x] Connect to ProjectManagementStore for data
- [x] Handle loading and error states in UI
- [x] Unit test: Test dashboard component rendering and interactions

### Task 5: Implement Project Creation Flow (AC: 1)
- [x] Create `apps/web/app/(authenticated)/projects/create/page.tsx`
- [x] Build project creation form with validation
- [x] Implement form submission with store integration
- [x] Add success/error feedback and navigation
- [x] Unit test: Test form validation and submission
- [x] E2E test: Complete project creation workflow

### Task 6: Add Project Navigation and Access (AC: 3)
- [x] Implement project routing in `apps/web/app/(authenticated)/projects/[id]/`
- [x] Add navigation between dashboard and individual projects
- [x] Implement breadcrumb navigation
- [x] Update header component with project context
- [x] E2E test: Test navigation between projects and dashboard

## Testing
- All components must have unit tests co-located with source files
- API endpoints require integration tests with Firebase emulators
- E2E tests for complete user workflows using Playwright
- Tests must validate Australian compliance requirements (correlation IDs, audit trails)

## Dev Agent Record

### Checkboxes
Tasks and subtasks will be marked complete as implemented.

### Debug Log References
Correlation IDs will be logged for all development debugging.

### Completion Notes
**Task 1 Completed**: Project data models and types implemented with comprehensive validation schemas and unit tests. Added Zod dependency for robust schema validation.

**Task 2 Completed**: Backend project service implemented with full CRUD operations, proper error handling, audit trails, and comprehensive testing. All operations use australia-southeast1 region and include correlation IDs for Australian compliance.

**Task 3 Completed**: Frontend project management store implemented using Zustand with complete CRUD operations, async state handling, UI state management, and comprehensive unit tests. Includes correlation ID generation and proper error handling.

**Task 4 Completed**: Project dashboard UI implemented with responsive design, project cards, search/filtering, loading states, error handling, and comprehensive unit tests. Fully connected to ProjectManagementStore with proper state management.

**Task 5 Completed**: Project creation flow implemented with comprehensive form validation using react-hook-form and Zod, store integration, success/error feedback, navigation, and complete unit test coverage. Includes character counting, field validation, loading states, and proper UX patterns for form handling.

**Task 6 Completed**: Project navigation and access implemented with dynamic routing, individual project pages, breadcrumb navigation, enhanced project cards with navigation, and comprehensive unit tests. Projects can now be viewed individually with detailed information, timeline, and management actions.

### File List
**Created Files:**
- `packages/shared-types/src/database/project-schema.ts` - Project database schema with Zod validation
- `packages/shared-types/src/api/project-types.ts` - API request/response types
- `packages/shared-types/src/database/project-schema.test.ts` - Unit tests for schema validation
- `packages/shared-types/src/api/project-types.test.ts` - Unit tests for API types
- `functions/src/services/data-management/project-service.ts` - Core project service with CRUD operations
- `functions/src/services/data-management/project-service.test.ts` - Unit tests for project service
- `functions/src/api/projects/index.ts` - HTTP API endpoints for project management
- `functions/src/api/projects/index.test.ts` - Integration tests for API endpoints
- `apps/web/lib/stores/project-management.ts` - Zustand store for project management
- `apps/web/lib/stores/project-management.test.ts` - Unit tests for project store
- `apps/web/app/(authenticated)/dashboard/page.tsx` - Main dashboard page component
- `apps/web/components/features/project-management/project-card.tsx` - Project card component
- `apps/web/components/features/project-management/project-filters.tsx` - Search and filtering component
- `apps/web/components/features/project-management/project-list.tsx` - Project list with loading/error states
- `apps/web/components/features/project-management/project-card.test.tsx` - Unit tests for project card
- `apps/web/components/features/project-management/project-list.test.tsx` - Unit tests for project list
- `apps/web/app/(authenticated)/projects/create/page.tsx` - Project creation page with form validation
- `apps/web/app/(authenticated)/projects/create/page.test.tsx` - Unit tests for project creation page
- `apps/web/app/(authenticated)/projects/[id]/page.tsx` - Individual project page with detailed view
- `apps/web/app/(authenticated)/projects/[id]/page.test.tsx` - Unit tests for individual project page

**Modified Files:**
- `packages/shared-types/src/index.ts` - Added exports for new types
- `packages/shared-types/package.json` - Added Zod dependency
- `functions/src/index.ts` - Added export for project API endpoint
- `apps/web/components/features/project-management/project-card.tsx` - Enhanced with navigation and improved UX
- `apps/web/components/header.tsx` - Enhanced with authenticated variant and project context

### Change Log
Will track all significant changes made during development.